\documentclass[../thesis.tex]{subfiles}

\begin{document}

\section{Omaduspõhine testimine}
Omaduspõhine testimine (ingl. \textit{property-based testing}) on programmide testimise metoodika, mis põhineb soovitud omaduste verifitseerimisel juhuslikult genereeritud testandmetel. Selle lähenemise populariseeris Haskelli teek nimega QuickCheck, mis on nüüdseks implementeeritud ka paljude teiste programmeerimiskeelte jaoks ja mille kasutamine on funktsionaalprogrammeerimises laialdane.

Omaduspõhine testimine sobib hästi matemaatilist laadi omaduste, nagu eelmises peatükis toodud domeenide omaduste, kontrollimiseks, sest seda saab teha lihtsa tingimusega, vajamata sobivate testandmete väljamõtlemist. See võimaldab samu omadusi kontrollida kõigil domeenidel, sõltumata isegi nende elementide tüübist.

\subsection{Põhimõtted}
Testitavad omadused kirjeldatakse predikaatidena, millele omaduspõhise testimise raamistik genereerib hulga juhuslikke argumente, millel arvutab välja predikaadi väärtuse. Kui see on kõigil genereeritud argumentidel tõene, siis loetakse test läbituks ja omadus kehtivaks. Kui mõnel argumendil on predikaat väär, loetakse test läbikukkunuks ja omadus mittekehtivaks. Viimasel juhul kuvatakse probleemne argument ka testijale.

Omaduspõhise testimise raamistikes on tüüpiliselt juba defineeritud, kuidas vastava keele põhiliste andmetüüpide, sh paaride, järjendite jne, väärtusi juhuslikult genereerida. Puuduvate ja enda defineeritud andmetüüpide jaoks tuleb see ise juurde lisada. Seejuures \enquote{juhuslik} ei pea tähendama täielikult juhuslikku protsessi, vaid võib alati genereerida ka hulka huvitavaid ja sageli probleeme tekitavaid erijuhte (nt arv null, tühi järjend jne).

Juhuslikult genereeritud argumendid võivad olla \enquote{suured}: suured arvud, pikad sõned või järjendid, sügavad puud jne. Võib kergesti juhtuda, et mõne omaduse kontranäide on seetõttu inimese jaoks raskesti hoomatav ja jääb ebaselgeks, mis on selle argumendi juures erilist, et omadus ei kehti. Vigade analüüsimise lihtsustamiseks kasutatakse omaduspõhises testimises vääravate argumentide lihtsustamist ehk vähendamist (ingl. \textit{shrinking}). Kirjeldatakse, kuidas leitud väärtusest saada lihtsamaid, mis oleks algsega piisavalt sarnased, et nende korral võiks omadus samuti mitte kehtida. Näiteks järjendist mingite elementide eemaldamine, et pikkus sellest väheneks. Vähendatud argumentidel väärtustatakse predikaat uuesti, leidmaks neid, mille korral omadus ikka ei kehti, ja rakendatakse vähendamist taas nii palju kordi kui võimalik, et lihtsustada probleemset argumenti maksimaalselt, muutes selle paremini hoomatavaks.

Tüüpiliselt on ka põhiliste andmetüüpide vähendaminie testimisraamistikesse juba sisse ehitatud, aga sedagi on võimalik ise laiendada oma andmetüüpidele.

\TODO{Teek \enquote{qcheck}}

\subsection{Goblint}

\begin{figure}
	\centering
	\begin{bminted}[mathescape]{ocaml}
		module type S =
		sig
		  type t (* domeeni elementide tüüp *)
		  val equal: t -> t -> bool (* seos $=$ *)
		  val leq: t -> t -> bool (* seos $\sqleq$ *)
		  val join: t -> t -> t (* tehe $\sqcup$ *)
		  val meet: t -> t -> t (* tehe $\sqcap$ *)
		  val bot: unit -> t (* element $\bot$ *)
		  val is_bot: t -> bool
		  val top: unit -> t (* element $\top$ *)
		  val is_top: t -> bool
		  val widen: t -> t -> t (* tehe $\widen$ *)
		  val narrow: t -> t -> t (* tehe $\narrow$ *)
		end
	\end{bminted}
	\caption{Domeeni (lihtsustatud) signatuur Goblinti moodulis \texttt{Lattice}.}
	\label{fig:lattice-s}
\end{figure}

\begin{minted}{ocaml}
	val arbitrary: unit -> t QCheck.arbitrary
\end{minted}

\TODO{\textit{bottom-up}, \textit{top-down} lähenemised}
\TODO{Testimise tulemused}


\end{document}